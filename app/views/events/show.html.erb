<% # Only load Google Maps API with this page %>
<script>
function initialize() {
  var mapOptions = {
    center: { lat: -34.397, lng: 150.644},
    zoom: 8
  };
  var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
}

function loadScript() {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyA3kuSBttz56OnHl3kindQadgztLk4IS-U&callback=initialize';
  document.body.appendChild(script);
}

loadScript();
</script>

<div class="row">
  <div class="col-md-4">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <%= @event.activity %> 
        <%= link_to edit_event_path(@event), class: 'pull-right' do %>
          <span class="glyphicon glyphicon-pencil" style="color: #FFFFFF"></span>
        <% end %>
      </div>
      <ul class="list-group">
        <li class="list-group-item"><strong>When:</strong> <%= @event.datetime.strftime('%e %b, %l%p') %></li>
        <li class="list-group-item"><strong>Where:</strong> <%= @event.location %></li>
        <li class="list-group-item"><strong>Details:</strong> <%= @event.description %></li>
        <li class="list-group-item"><strong>Host:</strong> <%= @event.user.handle %></li>
        <li class="list-group-item">
          <strong>Invited:</strong> 
          <% if @invited.empty? %>
          none
          <% end %>
          <% @invited.each do |user| %>
          <%= user.handle %>
          <% end %>
        </li>
        <li class="list-group-item">
          <strong>Invite friends:</strong> 
          <%= form_tag '/notifications', method: :post, class: 'form-inline' do %>
            <%= hidden_field_tag :event_id, @event.id %>
            <%= select_tag :target, options_for_select(@others.map{|u|[u.handle, u.id]}) %>
            <%= submit_tag 'Invite' %>
          <% end %>
        </li>
      </ul>
    </div>
  </div>
</div>

<div class="row">
  <%= render 'card' %>
</div>

<div class="row">
  <div class="col-md-4">
    <%= link_to 'Back', events_path %>
  </div>
</div>